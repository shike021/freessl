{"remainingRequest":"/root/work/freessl/free_ssl_service/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/work/freessl/free_ssl_service/frontend/src/views/Dashboard.vue?vue&type=script&lang=js","dependencies":[{"path":"/root/work/freessl/free_ssl_service/frontend/src/views/Dashboard.vue","mtime":1744469502171},{"path":"/root/work/freessl/free_ssl_service/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1744473453885},{"path":"/root/work/freessl/free_ssl_service/frontend/node_modules/vue-loader/lib/index.js","mtime":1744473443223}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnYXV0aCcsIFsndXNlciddKSwKICAgIC4uLm1hcFN0YXRlKCdjZXJ0cycsIFsnY2VydGlmaWNhdGVzJ10pLAogICAgdmFsaWRDZXJ0aWZpY2F0ZXNDb3VudCgpIHsKICAgICAgcmV0dXJuIHRoaXMuY2VydGlmaWNhdGVzLmZpbHRlcihjZXJ0ID0+ICF0aGlzLmlzRXhwaXJlZChjZXJ0LmV4cGlyeV9kYXRlKSkubGVuZ3RoCiAgICB9LAogICAgZXhwaXJpbmdDZXJ0aWZpY2F0ZXNDb3VudCgpIHsKICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKQogICAgICBjb25zdCB0aHJlc2hvbGQgPSBuZXcgRGF0ZShub3cuc2V0RGF0ZShub3cuZ2V0RGF0ZSgpICsgMzApKQogICAgICByZXR1cm4gdGhpcy5jZXJ0aWZpY2F0ZXMuZmlsdGVyKGNlcnQgPT4KICAgICAgICBuZXcgRGF0ZShjZXJ0LmV4cGlyeV9kYXRlKSA+IG5vdyAmJiBuZXcgRGF0ZShjZXJ0LmV4cGlyeV9kYXRlKSA8PSB0aHJlc2hvbGQKICAgICAgKS5sZW5ndGgKICAgIH0sCiAgICBleHBpcmVkQ2VydGlmaWNhdGVzQ291bnQoKSB7CiAgICAgIHJldHVybiB0aGlzLmNlcnRpZmljYXRlcy5maWx0ZXIoY2VydCA9PiB0aGlzLmlzRXhwaXJlZChjZXJ0LmV4cGlyeV9kYXRlKSkubGVuZ3RoCiAgICB9LAogICAgcmVjZW50Q2VydGlmaWNhdGVzKCkgewogICAgICByZXR1cm4gWy4uLnRoaXMuY2VydGlmaWNhdGVzXS5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmlzc3VlX2RhdGUpIC0gbmV3IERhdGUoYS5pc3N1ZV9kYXRlKSkuc2xpY2UoMCwgNSkKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWRDZXJ0aWZpY2F0ZXMoKQogIH0sCiAgbWV0aG9kczogewogICAgLi4ubWFwQWN0aW9ucygnY2VydHMnLCBbJ2ZldGNoQ2VydGlmaWNhdGVzJ10pLAogICAgCiAgICBhc3luYyBsb2FkQ2VydGlmaWNhdGVzKCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdGhpcy5mZXRjaENlcnRpZmljYXRlcygpCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5Yqg6L296K+B5Lmm5aSx6LSlOiAnICsgKGVycm9yLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlIHx8IGVycm9yLm1lc3NhZ2UpKQogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICAKICAgIGZvcm1hdERhdGUoZGF0ZSkgewogICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCkKICAgIH0sCiAgICAKICAgIGlzRXhwaXJlZChleHBpcnlEYXRlKSB7CiAgICAgIHJldHVybiBuZXcgRGF0ZShleHBpcnlEYXRlKSA8IG5ldyBEYXRlKCkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Dashboard.vue"],"names":[],"mappings":";AA0CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Dashboard.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"dashboard\">\n    <el-row :gutter=\"20\" class=\"mb-20\">\n      <el-col :span=\"12\">\n        <el-card class=\"summary-card\">\n          <h3>证书概览</h3>\n          <p>有效证书: {{ validCertificatesCount }}</p>\n          <p>即将到期: {{ expiringCertificatesCount }}</p>\n          <p>已过期: {{ expiredCertificatesCount }}</p>\n        </el-card>\n      </el-col>\n      \n      <el-col :span=\"12\">\n        <el-card class=\"summary-card\">\n          <h3>用户信息</h3>\n          <p>用户名: {{ user.username }}</p>\n          <p>邮箱: {{ user.email }}</p>\n        </el-card>\n      </el-col>\n    </el-row>\n    \n    <el-card class=\"recent-activity\">\n      <h3>最近活动</h3>\n      <el-table :data=\"recentCertificates\" v-loading=\"loading\">\n        <el-table-column prop=\"domains\" label=\"域名\" min-width=\"200\"></el-table-column>\n        <el-table-column prop=\"issue_date\" label=\"申请日期\" width=\"150\">\n          <template #default=\"{ row }\">\n            {{ formatDate(row.issue_date) }}\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"expiry_date\" label=\"过期日期\" width=\"150\">\n          <template #default=\"{ row }\">\n            <span :class=\"{'text-danger': isExpired(row.expiry_date)}\">\n              {{ formatDate(row.expiry_date) }}\n            </span>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n  </div>\n</template>\n<script>\nimport { mapState, mapActions } from 'vuex'\n\nexport default {\n  data() {\n    return {\n      loading: false\n    }\n  },\n  computed: {\n    ...mapState('auth', ['user']),\n    ...mapState('certs', ['certificates']),\n    validCertificatesCount() {\n      return this.certificates.filter(cert => !this.isExpired(cert.expiry_date)).length\n    },\n    expiringCertificatesCount() {\n      const now = new Date()\n      const threshold = new Date(now.setDate(now.getDate() + 30))\n      return this.certificates.filter(cert =>\n        new Date(cert.expiry_date) > now && new Date(cert.expiry_date) <= threshold\n      ).length\n    },\n    expiredCertificatesCount() {\n      return this.certificates.filter(cert => this.isExpired(cert.expiry_date)).length\n    },\n    recentCertificates() {\n      return [...this.certificates].sort((a, b) => new Date(b.issue_date) - new Date(a.issue_date)).slice(0, 5)\n    }\n  },\n  created() {\n    this.loadCertificates()\n  },\n  methods: {\n    ...mapActions('certs', ['fetchCertificates']),\n    \n    async loadCertificates() {\n      this.loading = true\n      try {\n        await this.fetchCertificates()\n      } catch (error) {\n        this.$message.error('加载证书失败: ' + (error.response?.data?.message || error.message))\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    formatDate(date) {\n      return new Date(date).toLocaleDateString()\n    },\n    \n    isExpired(expiryDate) {\n      return new Date(expiryDate) < new Date()\n    }\n  }\n}\n</script>\n<style scoped>\n.dashboard {\n  padding: 20px;\n}\n\n.mb-20 {\n  margin-bottom: 20px;\n}\n\n.summary-card {\n  height: 150px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n}\n\n.recent-activity {\n  margin-top: 20px;\n}\n\n.text-danger {\n  color: #f56c6c;\n}\n</style>\n"]}]}