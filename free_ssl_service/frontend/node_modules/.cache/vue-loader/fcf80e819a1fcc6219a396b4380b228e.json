{"remainingRequest":"/root/work/freessl/free_ssl_service/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/work/freessl/free_ssl_service/frontend/src/views/Dashboard.vue?vue&type=style&index=0&id=22ba47ca&scoped=true&lang=css","dependencies":[{"path":"/root/work/freessl/free_ssl_service/frontend/src/views/Dashboard.vue","mtime":1744469502171},{"path":"/root/work/freessl/free_ssl_service/frontend/node_modules/css-loader/dist/cjs.js","mtime":1744473453671},{"path":"/root/work/freessl/free_ssl_service/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1744473443888},{"path":"/root/work/freessl/free_ssl_service/frontend/node_modules/postcss-loader/src/index.js","mtime":1744473453093},{"path":"/root/work/freessl/free_ssl_service/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1744473453885},{"path":"/root/work/freessl/free_ssl_service/frontend/node_modules/vue-loader/lib/index.js","mtime":1744473443223}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5kYXNoYm9hcmQgewogIHBhZGRpbmc6IDIwcHg7Cn0KCi5tYi0yMCB7CiAgbWFyZ2luLWJvdHRvbTogMjBweDsKfQoKLnN1bW1hcnktY2FyZCB7CiAgaGVpZ2h0OiAxNTBweDsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0KCi5yZWNlbnQtYWN0aXZpdHkgewogIG1hcmdpbi10b3A6IDIwcHg7Cn0KCi50ZXh0LWRhbmdlciB7CiAgY29sb3I6ICNmNTZjNmM7Cn0K"},{"version":3,"sources":["Dashboard.vue"],"names":[],"mappings":";AAkGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"Dashboard.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"dashboard\">\n    <el-row :gutter=\"20\" class=\"mb-20\">\n      <el-col :span=\"12\">\n        <el-card class=\"summary-card\">\n          <h3>证书概览</h3>\n          <p>有效证书: {{ validCertificatesCount }}</p>\n          <p>即将到期: {{ expiringCertificatesCount }}</p>\n          <p>已过期: {{ expiredCertificatesCount }}</p>\n        </el-card>\n      </el-col>\n      \n      <el-col :span=\"12\">\n        <el-card class=\"summary-card\">\n          <h3>用户信息</h3>\n          <p>用户名: {{ user.username }}</p>\n          <p>邮箱: {{ user.email }}</p>\n        </el-card>\n      </el-col>\n    </el-row>\n    \n    <el-card class=\"recent-activity\">\n      <h3>最近活动</h3>\n      <el-table :data=\"recentCertificates\" v-loading=\"loading\">\n        <el-table-column prop=\"domains\" label=\"域名\" min-width=\"200\"></el-table-column>\n        <el-table-column prop=\"issue_date\" label=\"申请日期\" width=\"150\">\n          <template #default=\"{ row }\">\n            {{ formatDate(row.issue_date) }}\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"expiry_date\" label=\"过期日期\" width=\"150\">\n          <template #default=\"{ row }\">\n            <span :class=\"{'text-danger': isExpired(row.expiry_date)}\">\n              {{ formatDate(row.expiry_date) }}\n            </span>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n  </div>\n</template>\n<script>\nimport { mapState, mapActions } from 'vuex'\n\nexport default {\n  data() {\n    return {\n      loading: false\n    }\n  },\n  computed: {\n    ...mapState('auth', ['user']),\n    ...mapState('certs', ['certificates']),\n    validCertificatesCount() {\n      return this.certificates.filter(cert => !this.isExpired(cert.expiry_date)).length\n    },\n    expiringCertificatesCount() {\n      const now = new Date()\n      const threshold = new Date(now.setDate(now.getDate() + 30))\n      return this.certificates.filter(cert =>\n        new Date(cert.expiry_date) > now && new Date(cert.expiry_date) <= threshold\n      ).length\n    },\n    expiredCertificatesCount() {\n      return this.certificates.filter(cert => this.isExpired(cert.expiry_date)).length\n    },\n    recentCertificates() {\n      return [...this.certificates].sort((a, b) => new Date(b.issue_date) - new Date(a.issue_date)).slice(0, 5)\n    }\n  },\n  created() {\n    this.loadCertificates()\n  },\n  methods: {\n    ...mapActions('certs', ['fetchCertificates']),\n    \n    async loadCertificates() {\n      this.loading = true\n      try {\n        await this.fetchCertificates()\n      } catch (error) {\n        this.$message.error('加载证书失败: ' + (error.response?.data?.message || error.message))\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    formatDate(date) {\n      return new Date(date).toLocaleDateString()\n    },\n    \n    isExpired(expiryDate) {\n      return new Date(expiryDate) < new Date()\n    }\n  }\n}\n</script>\n<style scoped>\n.dashboard {\n  padding: 20px;\n}\n\n.mb-20 {\n  margin-bottom: 20px;\n}\n\n.summary-card {\n  height: 150px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n}\n\n.recent-activity {\n  margin-top: 20px;\n}\n\n.text-danger {\n  color: #f56c6c;\n}\n</style>\n"]}]}